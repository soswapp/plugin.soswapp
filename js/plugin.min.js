function removeAlert(){var e=$(document).find("#sos-alert-cover");e.length>0&&e.animate({opacity:0},300,function(){e.remove()})}"undefined"==typeof sos&&(window.sos={}),"object"!=typeof sos.config&&(sos.config={}),sos.alert=function(e,s){var t={type:"info",tymout:0,exit:"Okay"};e=e.replace(/\\r\\n/g,"<br>").replace(/\\n/g,"<br>");s&&"object"==typeof s&&(in_array(s.type,["info","message","error","progress","success"])&&(t.type=s.type),void 0!==s.exit&&(t.exit=s.exit));var i={info:"Okay",message:"Okay",error:"Close",progress:"",success:"Continue"},o={info:' <i class="fas fa-info-circle"></i> ',error:' <i class="fas fa-times"></i> ',success:' <i class="fas fa-check"></i> ',message:' <i class="fas fa-arrow-right"></i> ',progress:""},a={info:"yellow",error:"red",success:"green",message:"white",progress:"blue"};$(document).find("#sos-alert-cover").length>0&&removeAlert();var r='<div id="sos-alert-cover"> <div id="sos-alert" class="alert '+t.type+' drop-shadow"> <div id="sos-alert-content">';"progress"==t.type&&(r+=' <p class="align-c"> '+{info:' <i class="fas fa-info fa-2x"></i> ',error:' <i class="fas fa-times fa-2x"></i> ',success:' <i class="fas fa-check fa-2x"></i> ',message:' <i class="fas fa-info-circle fa-2x"></i> ',progress:' <i class="fas fa-spinner fa-2x fa-spin"></i> '}[t.type]+"</p>"),r+=e,r+="</div> <footer>","progress"!==t.type&&!1!==t.exit&&(!0===t.exit&&(t.exit="Close"),"boolean"==typeof t.exit&&0==parseBool(t.exit)||(in_array(t.exit,i)?r+='  <button type="button" class="btn '+a[t.type]+'" onclick="removeAlert();">'+o[t.type]+i[t.type]+"</button>":r+='  <button type="button" class="sos-btn '+a[t.type]+'" onclick="removeAlert();">'+o[t.type]+t.exit+"</button>")),r+="</footer> </div> </div>",$("body").prepend(r),$(document).find("#sos-alert-cover").animate({opacity:1},300),parseInt(t.tymout)>0&&setTimeout(function(){removeAlert()},t.tymout)},window.alert=sos.alert,sos.randCode=function(e=8){let s="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz0123456789",i=t.length;for(var o=0;o<e;o++)s+=t.charAt(Math.floor(Math.random()*i));return s},sos.form={getInput:function(e,s=["file"]){if(s="object"==typeof s?s:[],"object"!=typeof e)return null;let t={},o=$(e).attr("id");if(o=null!==typeof o&&!1!==o&&o,!in_array("file",s)){if($(e).find("input[type=file]").length>0){var a=e.querySelectorAll("input[type=file]");for(i=0;i<a.length;++i){var r="file-"+i+"-";for(ii=0;ii<a[i].files.length;++ii)t[r+ii]=a[i].files[ii]}}if(!1!==o){let s=e.querySelectorAll(`input[type=file][form='${o}']`);if(s.length>0)for(i=0;i<s.length;++i){let e="filex-"+i+"-";for(ii=0;ii<s[i].files.length;++ii)t[e+ii]=s[i].files[ii]}}}if(!in_array("input",s)){let s=$(e).find("input");if(s.length>0&&s.each(function(){in_array($(this).attr("type"),["file","checkbox","radio"])||(t[$(this).attr("name")]=$(this).val())}),!1!==o){let e=$(document).find(`input[form='${o}']`);e.length>0&&e.each(function(){in_array($(this).attr("type"),["file","checkbox","radio"])||(t[$(this).attr("name")]=$(this).val())})}}if(!in_array("checkbox",s)){let s=$(e).find("input[type=checkbox]");if(s.length>0&&s.each(function(){let s=$(this).attr("name"),i=[];$(e).find(`input[name='${s}']`).each(function(){$(this).is(":checked")&&i.push($(this).val())}),i.length>0&&(t[s]=i.join(","))}),!1!==o){let e=$(document).find(`input[type=checkbox][form='${o}']`);e.length>0&&e.each(function(){$(this).is(":checked")&&(t[$(this).attr("name")]=$(this).val())})}}if(!in_array("radio",s)){let s=$(e).find("input[type=radio]");if(s.length>0&&s.each(function(){$(this).is(":checked")&&(t[$(this).attr("name")]=$(this).val())}),!1!==o){let e=$(document).find(`input[type=radio][form='${o}']`);e.length>0&&e.each(function(){$(this).is(":checked")&&(t[$(this).attr("name")]=$(this).val())})}}if(!in_array("select",s)){let s=$(e).find("select");if(s.length>0&&s.each(function(){t[$(this).attr("name")]=$(this).val()}),!1!==o){let e=$(document).find(`select[form='${o}']`);e.length>0&&e.each(function(){t[$(this).attr("name")]=$(this).val()})}}if(!in_array("textarea",s)){let s=$(e).find("textarea");if(s.length>0&&s.each(function(){t[$(this).attr("name")]=$(this).val()}),!1!==o){let e=$(document).find(`textarea[form='${o}']`);e.length>0&&e.each(function(){t[$(this).attr("name")]=$(this).val()})}}return t},validate:function(e){return console.error("sos.form.validate: NOT READY FOR USE"),!1},endpoint:function(e){let s=$(e).attr("action");if("undefined"===s||null===s||!s.is_valid_url()){s=($(e).data("domain")?$(e).data("domain"):document.location.origin)+($(e).data("path")?$(e).data("path"):"")+$(e).attr("action")}return s.is_valid_url()||console.error(`Invalid form[submit] endpoint: ${s}`),s},files:{},fileHash:{},remFile:function(e){e&&"undefined"!==sos.form.files[e]&&delete sos.form.files[e]&&($(document).find(`li#${e}`).remove(),delete sos.form.fileHash[e])},submit:function(e,s,t,o,a){if(t&&!sos.form.validate.all(e))return console.error("Form was not submitted due to validation error(s)"),!1;let r=$(e).attr("method").toLowerCase();if("get"==r&&$(e).find("input[type=file]").length>0)return sos.alert("<h2>Wrong form request [method] </h2> <p>Kindly use 'POST' [method] for forms with file upload.</p>",{type:"error"}),!1;let n,l=sos.form.getInput(e);if("object"!=typeof l||l.length<=0)return alert("<h2>[3.1] Input error </h2> <p>No form input processed.</p>",{type:"error",exit:!0}),console.error("SOS form not properly configured or has no valid input/value"),!1;if("get"==r?n=$.param(l):(n=new FormData,$.each(l,function(e,s){n.append(e,s)})),!sos.form.endpoint(e).is_valid_url())return!1;sos.alert("Please wait..",{type:"progress",exit:!1}),a="object"==typeof a?a:{};var f={url:sos.form.endpoint(e),type:r,headers:a,data:n,contentType:!1,processData:"post"!=r,xhr:function(){var e=$.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",sos.loader.progress,!1),e},success:function(t){if(void 0==t.status||void 0==t.message||void 0==t.errors){var a=" <h4>Response detail</h4>";a+="object"==typeof t?JSON.stringify(t):t,sos.alert("<h3>[4.0]: Unknown response error.</h3> <div>"+a+"</div>",{type:"error",exit:!0})}else if("0.0"==t.status||"00"==t.status)o&&$(e).trigger("reset"),sos.alert("<h3>[0.0]: Success!</h3> <div>"+t.message+"</div>",{type:"success",tymout:18e3,exit:!0}),"function"==typeof s&&s(t);else if("0.1"==t.status)sos.alert("<h3>[0.1]: No change(s) made.</h3> <div>"+t.message+"</div>",{type:"message",tymout:15e3,exit:!0});else if("0.2"==t.status)sos.alert("<h3>[0.2]: No result(s) found.</h3> <div>"+t.message+"</div>",{type:"message",tymout:15e3,exit:!0});else if("0.3"==t.status)sos.alert("<h3>[0.3]: Action required.</h3> <div>"+t.message+"</div>",{type:"info",tymout:15e3,exit:!0});else{var r="<h3> ["+t.status+"]: "+t.message+"</h3>";for(r+="<strong>Errors:</strong> <ol>",i=0;i<t.errors.length;i++)r+="<li>"+t.errors[i]+"</li>";if(r+="</ol>",t.uploaded_files&&t.uploaded_files.length>0){for(r+="<strong>Uploaded Files:</strong><br><ol>",i=0;i<t.uploaded_files.length;i++)r+='<li> <a href="'+t.uploaded_files[i].url+'" target="_blank" title="Click to view"> File '+i+"</a></li>";r+="</ol>"}if(t.failed_files&&t.failed_files.length>0){for(r+="<strong>Failed Files:</strong><br><ol>",i=0;i<t.failed_files.length;i++)r+="<li> "+t.failed_files[i].name+" | Type: "+t.failed_files[i].type+" | Size in bytes: "+fromByte(t.failed_files[i].size)+"</li>";r+="</ol>"}sos.alert(r,{type:"error",exit:!0})}},error:function(e,s,t){var i="<h3>[Unknown]: Error(s)</h3> <div>"+e.responseText+"</div>";sos.alert(i,{type:"error",exit:!0})},dataType:"json"};$.ajax(f)}},sos.form.initFile=function(e,s){$(s).length<=0&&console.error("DOM: stats bar not provided");let t=[];if(e.files.length>0){let s=e.files;for(let e=0;e<s.length;e++){let i,o=e;if(o+=s[e].name,o+=s[e].size,i=(o+=s[e].type).hashCode(),!in_array(i,Object.values(sos.form.fileHash))){let o=sos.randCode(12);sos.form.fileHash[o]=i,sos.form.files[o]=s[e],t.push({id:o,hash:i,name:s[e].name,size:s[e].size,type:s[e].type})}}}if($(s).length>0&&t.length>0){let e,i,o,a,r;$(document).find("#sos-frm-upldr-stat").length<=0?($(s).html($('<div id="sos-frm-upldr-stat"><ul class="fl-lst"></ul></div>')),e=$(document).find("#sos-frm-upldr-stat ul.fl-lst")):e=$(document).find("#sos-frm-upldr-stat ul.fl-lst"),$.each(t,function(s,t){r=t.name.substr(t.name.lastIndexOf(".")+1),o=file_group(r.toLowerCase()),a="number"==typeof(a=byte_size(t.size))[0]?number_format(a[0],2,".",",")+a[1]:"0.0",(i=$(`<li id="${t.id}"> <span class="ficon ${o}"></span>  <span class="fname">${t.name}</span> <span class="fsize">${a}</span></li>`)).append($(`<div class="prgs" id="sos-upl-prog-${t.id}"></div>`)).append($('<span class="stat-uploadn"><i class="fas fa-spinner fa-pulse"></i></span>')).append($('<span class="stat-waitn"><i class="fas fa-hourglass-half"></i></span>')).append($('<span class="stat-failed"><i class="fas fa-exclamation-triangle"></i></span>')).append($('<span class="stat-done"><i class="fas fa-check-circle"></i></span>')).append($(`<button id="fl-rm-${t.id}" onclick="sos.form.remFile('${t.id}');" class="sos-btn red frmv"><i class="fas fa-times fa-sm"></i></button>`)),e.append(i)})}return sos.form.files.length<1&&console.error(`No file input found for given [form] with id: ${form}`),sos.form.files},sos.form.resetFiles=(()=>{Object.keys(sos.form.files).length>0&&(sos.form.files={},sos.form.fileHash={})}),sos.form.uploadProgress=function(e,s){if("object"!=typeof s)return console.error("Invalid upload response data [upl]"),!1;let t=$(document).find(`#sos-upl-prog-${e}`);$(document).find(`li#${e}`).removeClass("waitn").addClass("uploadn");let i=Math.round(100*s.loaded/s.total);i<=100&&t.css("width",`${i}%`),i>=100&&$(document).find(`li#${e}`).removeClass("uploadn").addClass("done")},sos.form.upload=function(e,s,t){if($(sos.form.files).length<1)return console.error("No file was initialized"),!1;let i,o,a=sos.form.getInput(e,["file"]),r=sos.form.endpoint(e),n=[],l=0;function f(e,s){l===Object.keys(sos.form.files).length&&(n.length>0?sos.alert(n.join("<hr>"),{type:"error"}):"0.0"===e.status&&"function"==typeof window[s]&&window[s](e))}$(document).find(".hide-on-submit, .sos-file-trigger").hide(),$(e).find("input[type=submit], button[type=submit]").prop("disabled",!0).hide(),$.each(sos.form.files,function(e,d){(i=new FormData).append(e,d),$.each(a,function(e,s){i.append(e,s)}),s="object"==typeof s?s:{},$(`#${e}`).removeClass("waitn").addClass("uploadn"),o={url:r,type:"post",headers:s,data:i,contentType:!1,processData:!1,xhr:function(){var s=$.ajaxSettings.xhr();return s.upload&&s.upload.addEventListener("progress",function(s){sos.form.uploadProgress(e,s)},!1),s},success:function(s){var i;if(++l,void 0==s.status||void 0==s.message||void 0==s.errors)$(`#${e}`).removeClass("uploadn done").addClass("failed"),i+="object"==typeof s?JSON.stringify(s):s,n.push(`<h2>[x.x]: Error uploading #${e} - ${d.name}</h2> <p> ${i}</p> `);else if("0.0"==s.status||"00"==s.status)$(`#${e}`).removeClass("uploadn").addClass("done");else{let t=`<h2>[${s.status}]: Error uploading #${e} - ${d.name}</h2>`;object_length(s.errors)>0&&(t+=`<p>${s.message}</p>`,t+="<ol>",$.each(s.errors,function(e,s){t+=`<li>${s}</li>`}),t+="</ol>"),$(`#${e}`).removeClass("uploadn done").addClass("failed"),n.push(t)}f(s,t)},error:function(s,i,o){++l,$(`#${e}`).removeClass("uploadn done").addClass("failed"),n.push(`<h2>[x.x]: Error(s) occured while uploading #${e} - ${d.name}</h2> <div>${s.responseText}</div>`),f({status:"x.x",message:"Failed to load...",errors:n},t)}},$.ajax(o)})},TFsubmitForm=sos.form.submit,sos.loader={init:function(e,s){if($(document).find("#sos-loader").length<=0){var t='<div id="sos-loader"';(e="boolean"==typeof e&&e)&&(t+=' class="sos-loader-cover"'),t+='> <div id="sos-spinner"> <i class="fas fa-spinner fa-spin"></i></div> <div id="sos-loader-loaded"></div>',t+="</div>",$("body").prepend(t)}},progress:function(e){sos.loader.init();var s=$(document).find("#sos-loader-loaded"),t=Math.round(100*e.loaded/e.total);s.css({width:t+"%"}),t>=100&&setTimeout(sos.loader.exit,1200)},exit:function(){$(document).find("#sos-loader").fadeOut("slow").remove()}},sos.form.validate={all:function(e){return!0}},$(document).on("change","input[type='file'][data-action='sos-file-init']",function(){this.files.length>0&&(sos.form.initFile(this,$(this).data("stats")),0==$(this).prop("multiple")&&0==parseBool(param.upl_multiple)&&($(".frmv").remove(),$(".sos-file-trigger").hide().remove(),$(this).remove()))});