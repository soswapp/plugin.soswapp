function removeAlert(){var e=$(document).find("#sos-alert-cover");e.length>0&&e.animate({opacity:0},300,function(){e.remove()})}"undefined"==typeof sos&&(window.sos={}),"object"!=typeof sos.config&&(sos.config={}),sos.alert=function(e,t){var s={type:"info",tymout:0,exit:"Okay"};e=e.replace(/\\r\\n/g,"<br>").replace(/\\n/g,"<br>");t&&"object"==typeof t&&(in_array(t.type,["info","message","error","progress","success"])&&(s.type=t.type),void 0!==t.exit&&(s.exit=t.exit));var i={info:"Okay",message:"Okay",error:"Close",progress:"",success:"Continue"},o={info:' <i class="fas fa-info-circle"></i> ',error:' <i class="fas fa-times"></i> ',success:' <i class="fas fa-check"></i> ',message:' <i class="fas fa-arrow-right"></i> ',progress:""},a={info:"yellow",error:"red",success:"green",message:"white",progress:"blue"};$(document).find("#sos-alert-cover").length>0&&removeAlert();var r='<div id="sos-alert-cover"> <div id="sos-alert" class="alert '+s.type+' drop-shadow"> <div id="sos-alert-content">';"progress"==s.type&&(r+=' <p class="align-c"> '+{info:' <i class="fas fa-info fa-2x"></i> ',error:' <i class="fas fa-times fa-2x"></i> ',success:' <i class="fas fa-check fa-2x"></i> ',message:' <i class="fas fa-info-circle fa-2x"></i> ',progress:' <i class="fas fa-spinner fa-2x fa-spin"></i> '}[s.type]+"</p>"),r+=e,r+="</div> <footer>","progress"!==s.type&&!1!==s.exit&&(!0===s.exit&&(s.exit="Close"),"boolean"==typeof s.exit&&0==parseBool(s.exit)||(in_array(s.exit,i)?r+='  <button type="button" class="btn '+a[s.type]+'" onclick="removeAlert();">'+o[s.type]+i[s.type]+"</button>":r+='  <button type="button" class="sos-btn '+a[s.type]+'" onclick="removeAlert();">'+o[s.type]+s.exit+"</button>")),r+="</footer> </div> </div>",$("body").prepend(r),$(document).find("#sos-alert-cover").animate({opacity:1},300),parseInt(s.tymout)>0&&setTimeout(function(){removeAlert()},s.tymout)},window.alert=sos.alert,sos.randCode=function(e=8){let t="",s="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz0123456789",i=s.length;for(var o=0;o<e;o++)t+=s.charAt(Math.floor(Math.random()*i));return t},sos.form={getInput:function(e,t=["file"]){if(t="object"==typeof t?t:[],"object"!=typeof e)return null;let s={},o=$(e).attr("id");if(o=null!==typeof o&&!1!==o&&o,!in_array("file",t)){if($(e).find("input[type=file]").length>0){var a=e.querySelectorAll("input[type=file]");for(i=0;i<a.length;++i){var r="file-"+i+"-";for(ii=0;ii<a[i].files.length;++ii)s[r+ii]=a[i].files[ii]}}if(!1!==o){let t=e.querySelectorAll(`input[type=file][form='${o}']`);if(t.length>0)for(i=0;i<t.length;++i){let e="filex-"+i+"-";for(ii=0;ii<t[i].files.length;++ii)s[e+ii]=t[i].files[ii]}}}if(!in_array("input",t)){let t=$(e).find("input");if(t.length>0&&t.each(function(){in_array($(this).attr("type"),["file","checkbox","radio"])||(s[$(this).attr("name")]=$(this).val())}),!1!==o){let e=$(document).find(`input[form='${o}']`);e.length>0&&e.each(function(){in_array($(this).attr("type"),["file","checkbox","radio"])||(s[$(this).attr("name")]=$(this).val())})}}if(!in_array("checkbox",t)){let t=$(e).find("input[type=checkbox]");if(t.length>0&&t.each(function(){let t=$(this).attr("name"),i=[];$(e).find(`input[name='${t}']`).each(function(){$(this).is(":checked")&&i.push($(this).val())}),i.length>0&&(s[t]=i.join(","))}),!1!==o){let e=$(document).find(`input[type=checkbox][form='${o}']`);e.length>0&&e.each(function(){$(this).is(":checked")&&(s[$(this).attr("name")]=$(this).val())})}}if(!in_array("radio",t)){let t=$(e).find("input[type=radio]");if(t.length>0&&t.each(function(){$(this).is(":checked")&&(s[$(this).attr("name")]=$(this).val())}),!1!==o){let e=$(document).find(`input[type=radio][form='${o}']`);e.length>0&&e.each(function(){$(this).is(":checked")&&(s[$(this).attr("name")]=$(this).val())})}}if(!in_array("select",t)){let t=$(e).find("select");if(t.length>0&&t.each(function(){s[$(this).attr("name")]=$(this).val()}),!1!==o){let e=$(document).find(`select[form='${o}']`);e.length>0&&e.each(function(){s[$(this).attr("name")]=$(this).val()})}}if(!in_array("textarea",t)){let t=$(e).find("textarea");if(t.length>0&&t.each(function(){s[$(this).attr("name")]=$(this).val()}),!1!==o){let e=$(document).find(`textarea[form='${o}']`);e.length>0&&e.each(function(){s[$(this).attr("name")]=$(this).val()})}}return s},validate:function(e){return console.error("sos.form.validate: NOT READY FOR USE"),!1},endpoint:function(e){let t=$(e).attr("action");if("undefined"===t||null===t||!t.is_valid_url()){t=($(e).data("domain")?$(e).data("domain"):document.location.origin)+($(e).data("path")?$(e).data("path"):"")+$(e).attr("action")}return t.is_valid_url()||console.error(`Invalid form[submit] endpoint: ${t}`),t},files:{},remFile:function(e){e&&"undefined"!==sos.form.files[e]&&delete sos.form.files[e]&&$(document).find(`li#${e}`).remove()},submit:function(e,t,s,o,a){if(s&&!sos.form.validate.all(e))return console.error("Form was not submitted due to validation error(s)"),!1;let r=$(e).attr("method").toLowerCase();if("get"==r&&$(e).find("input[type=file]").length>0)return sos.alert("<h2>Wrong form request [method] </h2> <p>Kindly use 'POST' [method] for forms with file upload.</p>",{type:"error"}),!1;let n,l=sos.form.getInput(e);if("object"!=typeof l||l.length<=0)return alert("<h2>[3.1] Input error </h2> <p>No form input processed.</p>",{type:"error",exit:!0}),console.error("SOS form not properly configured or has no valid input/value"),!1;if("get"==r?n=$.param(l):(n=new FormData,$.each(l,function(e,t){n.append(e,t)})),!sos.form.endpoint(e).is_valid_url())return!1;sos.alert("Please wait..",{type:"progress",exit:!1}),a="object"==typeof a?a:{};var f={url:sos.form.endpoint(e),type:r,headers:a,data:n,contentType:!1,processData:"post"!=r,xhr:function(){var e=$.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",sos.loader.progress,!1),e},success:function(s){if(void 0==s.status||void 0==s.message||void 0==s.errors){var a=" <h4>Response detail</h4>";a+="object"==typeof s?JSON.stringify(s):s,sos.alert("<h3>[4.0]: Unknown response error.</h3> <div>"+a+"</div>",{type:"error",exit:!0})}else if("0.0"==s.status||"00"==s.status)o&&$(e).trigger("reset"),sos.alert("<h3>[0.0]: Success!</h3> <div>"+s.message+"</div>",{type:"success",tymout:18e3,exit:!0}),"function"==typeof t&&t(s);else if("0.1"==s.status)sos.alert("<h3>[0.1]: No change(s) made.</h3> <div>"+s.message+"</div>",{type:"message",tymout:15e3,exit:!0});else if("0.2"==s.status)sos.alert("<h3>[0.2]: No result(s) found.</h3> <div>"+s.message+"</div>",{type:"message",tymout:15e3,exit:!0});else if("0.3"==s.status)sos.alert("<h3>[0.3]: Action required.</h3> <div>"+s.message+"</div>",{type:"info",tymout:15e3,exit:!0});else{var r="<h3> ["+s.status+"]: "+s.message+"</h3>";for(r+="<strong>Errors:</strong> <ol>",i=0;i<s.errors.length;i++)r+="<li>"+s.errors[i]+"</li>";if(r+="</ol>",s.uploaded_files&&s.uploaded_files.length>0){for(r+="<strong>Uploaded Files:</strong><br><ol>",i=0;i<s.uploaded_files.length;i++)r+='<li> <a href="'+s.uploaded_files[i].url+'" target="_blank" title="Click to view"> File '+i+"</a></li>";r+="</ol>"}if(s.failed_files&&s.failed_files.length>0){for(r+="<strong>Failed Files:</strong><br><ol>",i=0;i<s.failed_files.length;i++)r+="<li> "+s.failed_files[i].name+" | Type: "+s.failed_files[i].type+" | Size in bytes: "+fromByte(s.failed_files[i].size)+"</li>";r+="</ol>"}sos.alert(r,{type:"error",exit:!0})}},error:function(e,t,s){var i="<h3>[Unknown]: Error(s)</h3> <div>"+e.responseText+"</div>";sos.alert(i,{type:"error",exit:!0})},dataType:"json"};$.ajax(f)}},sos.form.initFile=function(e,t){$(t).length<=0&&console.error("DOM: stats bar not provided");let s=[];if(e.files.length>0){let t=e.files;for(i=0;i<t.length;++i){let e=sos.randCode(12);sos.form.files[e]=t[i],s.push({id:e,name:t[i].name,size:t[i].size,type:t[i].type})}}if($(t).length>0&&s.length>0){let e,i,o,a,r;$(document).find("#sos-frm-upldr-stat").length<=0?($(t).html($('<div id="sos-frm-upldr-stat"><ul class="fl-lst"></ul></div>')),e=$(document).find("#sos-frm-upldr-stat ul.fl-lst")):e=$(document).find("#sos-frm-upldr-stat ul.fl-lst"),$.each(s,function(t,s){r=s.name.substr(s.name.lastIndexOf(".")+1),o=file_group(r.toLowerCase()),a="number"==typeof(a=byte_size(s.size))[0]?number_format(a[0],2,".",",")+a[1]:"0.0",(i=$(`<li id="${s.id}"> <span class="ficon ${o}"></span>  <span class="fname">${s.name}</span> <span class="fsize">${a}</span></li>`)).append($(`<div class="prgs" id="sos-upl-prog-${s.id}"></div>`)).append($('<span class="stat-uploadn"><i class="fas fa-spinner fa-pulse"></i></span>')).append($('<span class="stat-waitn"><i class="fas fa-hourglass-half"></i></span>')).append($('<span class="stat-failed"><i class="fas fa-exclamation-triangle"></i></span>')).append($('<span class="stat-done"><i class="fas fa-check-circle"></i></span>')).append($(`<button id="fl-rm-${s.id}" onclick="sos.form.remFile('${s.id}');" class="sos-btn red frmv"><i class="fas fa-times fa-sm"></i></button>`)),e.append(i)})}return sos.form.files.length<1&&console.error(`No file input found for given [form] with id: ${form}`),sos.form.files},sos.form.resetFiles=(()=>{Object.keys(sos.form.files).length>0&&(sos.form.files={})}),sos.form.uploadProgress=function(e,t){if("object"!=typeof t)return console.error("Invalid upload response data [upl]"),!1;let s=$(document).find(`#sos-upl-prog-${e}`);$(document).find(`li#${e}`).removeClass("waitn").addClass("uploadn");let i=Math.round(100*t.loaded/t.total);i<=100&&s.css("width",`${i}%`),i>=100&&$(document).find(`li#${e}`).removeClass("uploadn").addClass("done")},sos.form.upload=function(e,t,s){if($(sos.form.files).length<1)return console.error("No file was initialized"),!1;let i,o,a=sos.form.getInput(e,["file"]),r=sos.form.endpoint(e),n=[],l=0;function f(e,t){l===Object.keys(sos.form.files).length&&(n.length>0?sos.alert(n.join("<hr>"),{type:"error"}):"0.0"===e.status&&"function"==typeof window[t]&&window[t](e))}$(document).find(".hide-on-submit, .sos-file-trigger").hide(),$(e).find("input[type=submit], button[type=submit]").prop("disabled",!0).hide(),$.each(sos.form.files,function(e,d){(i=new FormData).append(e,d),$.each(a,function(e,t){i.append(e,t)}),t="object"==typeof t?t:{},$(`#${e}`).removeClass("waitn").addClass("uploadn"),o={url:r,type:"post",headers:t,data:i,contentType:!1,processData:!1,xhr:function(){var t=$.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",function(t){sos.form.uploadProgress(e,t)},!1),t},success:function(t){var i;if(++l,void 0==t.status||void 0==t.message||void 0==t.errors)$(`#${e}`).removeClass("uploadn done").addClass("failed"),i+="object"==typeof t?JSON.stringify(t):t,n.push(`<h2>[x.x]: Error uploading #${e} - ${d.name}</h2> <p> ${i}</p> `);else if("0.0"==t.status||"00"==t.status)$(`#${e}`).removeClass("uploadn").addClass("done");else{let s=`<h2>[${t.status}]: Error uploading #${e} - ${d.name}</h2>`;object_length(t.errors)>0&&(s+=`<p>${t.message}</p>`,s+="<ol>",$.each(t.errors,function(e,t){s+=`<li>${t}</li>`}),s+="</ol>"),$(`#${e}`).removeClass("uploadn done").addClass("failed"),n.push(s)}f(t,s)},error:function(t,i,o){++l,$(`#${e}`).removeClass("uploadn done").addClass("failed"),n.push(`<h2>[x.x]: Error(s) occured while uploading #${e} - ${d.name}</h2> <div>${t.responseText}</div>`),f({status:"x.x",message:"Failed to load...",errors:n},s)}},$.ajax(o)})},TFsubmitForm=sos.form.submit,sos.loader={init:function(e,t){if($(document).find("#sos-loader").length<=0){var s='<div id="sos-loader"';(e="boolean"==typeof e&&e)&&(s+=' class="sos-loader-cover"'),s+='> <div id="sos-spinner"> <i class="fas fa-spinner fa-spin"></i></div> <div id="sos-loader-loaded"></div>',s+="</div>",$("body").prepend(s)}},progress:function(e){sos.loader.init();var t=$(document).find("#sos-loader-loaded"),s=Math.round(100*e.loaded/e.total);t.css({width:s+"%"}),s>=100&&setTimeout(sos.loader.exit,1200)},exit:function(){$(document).find("#sos-loader").fadeOut("slow").remove()}},sos.form.validate={all:function(e){return!0}},$(document).on("change","input[type='file'][data-action='sos-file-init']",function(){this.files.length>0&&(sos.form.initFile(this,$(this).data("stats")),0==$(this).prop("multiple")&&0==parseBool(param.upl_multiple)&&($(".frmv").remove(),$(".sos-file-trigger").hide().remove(),$(this).remove()))});